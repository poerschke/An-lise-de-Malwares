#!/usr/bin/perl
use bignum;
use integer;
 
# Autor: Douglas Poerschke Rocha
 
my $debug = 0;
 
my $chave = 'jauSAFGGhgh_SEC_537Â¨%#$8732g6asd{OFF.LINES}SGH87y32g890{BERTIOLY}gbk+=('. "'";
my $cifrada = $ARGV[0];
 
my @cifra = split(//, $cifrada);
my $aux = $cifra[0].$cifra[1];
my $x = 2;
 
my @chars = split(//,$chave);
my @hexachave = ();
foreach my $char (@chars) {
push(@hexachave, uc(unpack("H*", $char)));
 
}
 
my $y=0;
 
for($x;$x<length($ARGV[0]);$x+=2){
 
my $c = sprintf("%s", $cifra[$x] . $cifra[$x+1]);
my $k = sprintf("%s", $hexachave[$y]);
my $o = sprintf("%s", hex($c) ^ hex($k)); # XOR EBX,EAX
printf("%s ^ %s : %s\n", $c, $k, $o) if($debug);
 
# CMP EDI,DWORD PTR SS:[EBP-1C]
# JL SHORT 0061E2F5
if(hex($aux) < $o){
 
printf("%s - %s: ", $o, $aux) if($debug);
$o -= hex($aux); # SUB DWORD PTR SS:[EBP-1C],EDI
printf("%s\n", $aux) if($debug);
}
else {
 
printf("%s + 0FF: ", $o) if($debug);
$o += hex("0FF"); # ADD EAX,0FF
printf("%s\n", $o) if($debug);
printf("%s - %s: ", $o, $aux) if($debug);
$o -= hex($aux); # SUB EAX,EDI
printf("%s\n", $o) if($debug);
 
}
print "res: ". pack("C",$o) . "\n------------\n" if($debug);
print pack("C",$o) if(!$debug);
$aux = $c;
$y++; # MOVZX EAX,WORD PTR DS:[EAX+ESI*2-2]
}
 
print "\n";